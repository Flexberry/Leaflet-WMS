/*! Leaflet-WMS 1.0.0 2016-11-25 */
!function(window,document,undefined){"use strict";String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){var c;if(null==this)throw new TypeError("'this' is null or not defined");var d=Object(this),e=d.length>>>0;if(0===e)return-1;var f=0|b;if(f>=e)return-1;for(c=Math.max(f>=0?f:e-Math.abs(f),0);c<e;){if(c in d&&d[c]===a)return c;c++}return-1}),Array.prototype.map||(Array.prototype.map=function(a,b){var c,d,e;if(null==this)throw new TypeError("'this' is null or not defined");var f=Object(this),g=f.length>>>0;if("function"!=typeof a)throw new TypeError(a+" is not a function");for(arguments.length>1&&(c=b),d=new Array(g),e=0;e<g;){var h,i;e in f&&(h=f[e],i=a.call(c,h,e,f),d[e]=i),e++}return d}),L.TileLayer.WMS.Util={},L.TileLayer.WMS.Util.JSON={parse:window.JSON?window.JSON.parse:function(jsonString){return eval("("+jsonString+")")}},L.TileLayer.WMS.Util.XML={normalize:function(a){var b,c,d=/^\s*$/;switch(a.nodeType){case 3:d.test(a.nodeValue)&&a.parentNode.removeChild(a);break;case 1:case 9:for(b=a.firstChild;b;)c=b.nextSibling,L.TileLayer.WMS.Util.XML.normalize(b),b=c}return a},parse:function(a){var b;try{if(window.DOMParser){var c=new window.DOMParser;b=c.parseFromString(a,"text/xml")}else window.ActiveXObject&&(b=new window.ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a))}catch(d){b=null}if(!b||!b.documentElement)throw new Error("Unable to parse specified 'xmlString' it isn't valid");var e=b.getElementsByTagName("parsererror");if(e.length>0){for(var f="",g=0,h=e.length;g<h;g++){var i=e[g];f+=L.TileLayer.WMS.Util.XML.getElementText(i).trim(),g<h-1&&(f+=" ")}throw new Error("Unable to parse specified 'xmlString' it isn't valid: "+f)}return L.TileLayer.WMS.Util.XML.normalize(b.documentElement)},getElementText:function(a){return a?a.innerText||a.textContent||a.text:""}},L.TileLayer.WMS.Util.XML.ExceptionReport={getExisting:function(){var a=[],b=L.TileLayer.WMS.Util.XML.ExceptionReport;for(var c in b){var d=b.hasOwnProperty(c)?b[c]:null;d&&"object"==typeof d&&"function"==typeof d.parse&&a.push(d)}return a},parse:function(a){for(var b=L.TileLayer.WMS.Util.XML.ExceptionReport.getExisting(),c=null,d=0,e=b.length;d<e;d++){var f=b[d];if(c=f.parse(a))break}return c}},L.TileLayer.WMS.Util.XML.ExceptionReport.OWS={parse:function(a){if("string"!=typeof a||a.indexOf("<ows:ExceptionReport")<0)return null;var b=L.TileLayer.WMS.Util.XML.parse(a);if(!b||"ows:ExceptionReport"!==b.tagName)return null;for(var c={exceptions:[],message:""},d=b.getElementsByTagName("Exception"),e=0,f=d.length;e<f;e++){for(var g=d[e],h=g.getAttribute("exceptionCode"),i=g.getElementsByTagName("ExceptionText"),j={code:h,text:""},k=0,l=i.length;k<l;k++){var m=i[k],n=L.TileLayer.WMS.Util.XML.getElementText(m).trim();j.text+=n,k<l-1&&(j.text+=" ")}c.message+=(j.code?j.code+" - ":"")+j.text+". ",c.exceptions.push(j)}return c}},L.TileLayer.WMS.Util.XML.ExceptionReport.Service={parse:function(a){if("string"!=typeof a||a.indexOf("<ServiceExceptionReport")<0)return null;var b=L.TileLayer.WMS.Util.XML.parse(a);if(!b||"ServiceExceptionReport"!==b.tagName)return null;for(var c={exceptions:[],message:""},d=b.getElementsByTagName("ServiceException"),e=0,f=d.length;e<f;e++){var g=d[e],h=g.getAttribute("code"),i={code:h,text:(h?h+" - ":"")+L.TileLayer.WMS.Util.XML.getElementText(g).trim()+". "};c.message+=i.text,c.exceptions.push(i)}return c}},function(){var a=function(){var a,b,c,d,e;for(a=0,b=arguments.length;a<b;a++){d=arguments[a],e=e||{};for(c in d)e[c]=d[c]}return e},b=function(a){return encodeURIComponent(a).replace(/[!'()*]/g,function(a){return"%"+a.charCodeAt(0).toString(16)})},c=function(a,c){var d,e;c=c||{},d=[];for(e in c)d.push(b(e)+"="+b(c[e]));return a=a||"",a+(a.indexOf("?")===-1?"?":"&")+d.join("&")},d=function(a){if("string"!=typeof a)return!1;var b=window.location,c=document.createElement("a");return c.href=a,""!==c.protocol&&b.protocol!==c.protocol||(""!==c.hostname&&b.hostname!==c.hostname||""!==c.port&&b.port!==c.port)},e=function(a){var b,c,e,f=!document.addEventListener||!document.querySelector;if(!window.ActiveXObject||window.XMLHttpRequest&&!f)window.XMLHttpRequest&&(b=new window.XMLHttpRequest);else for(var g=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP"],h=0,i=g.length;h<i;h++)try{b=new window.ActiveXObject(g[h])}catch(j){}b||(e=new Error("Your browser doesn't support neither 'XMLHttpRequest' nor 'ActiveXObject'"));var k="undefined"!=typeof b.withCredentials;d(a)&&!k&&(window.XDomainRequest?this.xdr=new window.XDomainRequest:e=new Error("Your browser doesn't support cross-domain requests")),this.url=a,this.xhr=b,this.xdr=c,this.error=e};e.prototype.send=function(b){b=a({method:"GET",headers:null,content:null,done:function(a,b){},fail:function(a,b){throw a},always:function(){}},b||{});var d=this.xdr||this.xhr,e=function(){"function"==typeof b.done&&b.done(d.responseText,d),"function"==typeof b.always&&b.always()},f=function(a){"function"==typeof b.fail&&b.fail(a,d),"function"==typeof b.always&&b.always()};if(this.error)return void f(this.error);if("string"==typeof b.method&&(b.method=b.method.trim().toUpperCase()),"GET"!==b.method&&"DELETE"!==b.method||(this.url=c(this.url,b.content),b.content=null,b.headers&&b.headers["Content-type"]&&delete b.headers["Content-type"]),d===this.xdr)d.open(b.method,this.url),d.onload=e,d.onerror=f,d.send(b.content);else{if(d.onreadystatechange=function(){var a,b;try{if(4!==d.readyState)return;a=1223===d.status?204:d.status}catch(c){a=0,b=c}a>=200&&a<300?e():f(b||new Error(a+" - "+d.responseText))},d.open(b.method,this.url,!0),b.headers)for(var g in b.headers)b.headers.hasOwnProperty(g)&&d.setRequestHeader(g,b.headers[g]);d.send(b.content)}},L.TileLayer.WMS.Util.AJAX=function(a){var b=new e(a.url);b.send(a)}}(),L.TileLayer.WMS.Format={getExisting:function(){var a=[],b=L.TileLayer.WMS.Format;for(var c in b){var d=b.hasOwnProperty(c)?b[c]:null;d&&"object"==typeof d&&"function"==typeof d.toGeoJSON&&a.push(c)}return a.sort(function(a,b){var c=L.TileLayer.WMS.Format[a],d=L.TileLayer.WMS.Format[b];return c.priority>d.priority?1:c.priority<d.priority?-1:0}),a}},L.TileLayer.WMS.Format["application/geojson"]={priority:1,toGeoJSON:function(a){return L.TileLayer.WMS.Util.JSON.parse(a)}},L.TileLayer.WMS.Format["application/json"]={priority:2,toGeoJSON:function(a){return L.TileLayer.WMS.Format["application/geojson"].toGeoJSON(a)}},L.TileLayer.WMS.Format["application/vnd.ogc.gml/3.1.1"]={priority:3,toGeoJSON:function(a){return L.TileLayer.WMS.Format["application/vnd.ogc.gml"].toGeoJSON(a)}},function(){var a={gml:"http://www.opengis.net/gml"},b={decimal:".",component:",",tuple:" "},c=["gml:Point","gml:MultiPoint","gml:LineString","gml:MultiLineString","gml:Polygon","gml:MultiPolygon"],d={toGeoJSON:function(a){return d[a.tagName].toGeoJSON(a)},"wfs:FeatureCollection":{toGeoJSON:function(a){return d["gml:featureCollection"].toGeoJSON(a)}},"gml:featureCollection":{toGeoJSON:function(b){for(var c={type:"FeatureCollection",features:[]},e=b.getElementsByTagNameNS(a.gml,"featureMember"),f=0,g=e.length;f<g;f++){var h=e[f],i=d.toGeoJSON(h);c.features.push(i)}return c}},"gml:featureMember":{toGeoJSON:function(a){for(var b={type:"Feature",geometry:null,properties:{}},e=a.firstChild,f=e.childNodes,g=0,h=f.length;g<h;g++){var i=f[g],j=i.tagName.split(":")[1],k=i.firstChild;k&&c.indexOf(k.tagName)>=0?b.geometry=d.toGeoJSON(k):b.properties[j]=L.TileLayer.WMS.Util.XML.getElementText(i)||null}return b}},"gml:coord":{toGeoJSON:function(b){var c=[],d=function(a){var b=window.parseFloat(L.TileLayer.WMS.Util.XML.getElementText(a));c.push(b)},e=b.getElementsByTagNameNS(a.gml,"X")[0];d(e);var f=b.getElementsByTagNameNS(a.gml,"Y")[0];d(f);var g=b.getElementsByTagNameNS(a.gml,"Z")[0];return g&&d(g),c}},"gml:coordinates":{toGeoJSON:function(a){for(var c=a.attributes,d=c.decimal&&c.decimal.value||b.decimal,e=c.cs&&c.cs.value||b.component,f=c.ts&&c.ts.value||b.tuple,g=[],h=L.TileLayer.WMS.Util.XML.getElementText(a).replace(new RegExp("s*"+e+"s*","g"),e).split(f),i=function(a){return"."!==d&&(a=a.replace(d,".")),window.parseFloat(a)},j=0,k=h.length;j<k;j++){var l=h[j].split(e).map(i);g.push(l)}return g.length>1?g:g[0]}},"gml:pos":{toGeoJSON:function(a){var c=a.attributes,d=c.decimal&&c.decimal.value||b.decimal,e=c.ts&&c.ts.value||b.tuple;return L.TileLayer.WMS.Util.XML.getElementText(a).split(e).map(function(a){return"."!==d&&(a=a.replace(d,".")),window.parseFloat(a)})}},"gml:posList":{toGeoJSON:function(a){for(var c=a.attributes,d=c.decimal&&c.decimal.value||b.decimal,e=c.ts&&c.ts.value||b.tuple,f=window.parseInt(c.srsDimension||c.dimension,10)||2,g=[],h=L.TileLayer.WMS.Util.XML.getElementText(a).split(e),i=0,j=h.length;i<j;i+=f){for(var k=[],l=i,m=i+f;l<m;l++){var n=h[l];"."!==d&&(n=n.replace(d,".")),k.push(window.parseFloat(n))}g.push(k)}return g}},"gml:Point":{toGeoJSON:function(a){var b={type:"Point",coordinates:[]},c=a.firstChild;return b.coordinates=d.toGeoJSON(c),b}},"gml:MultiPoint":{toGeoJSON:function(b){for(var c={type:"MultiPoint",coordinates:[]},e=b.getElementsByTagNameNS(a.gml,"Point"),f=0,g=e.length;f<g;f++){var h=e[f],i=d.toGeoJSON(h).coordinates;c.coordinates.push(i)}return c}},"gml:LineString":{toGeoJSON:function(a){var b,c={type:"LineString",coordinates:[]},e=a.childNodes;if(1===e.length)b=e[0],c.coordinates=d.toGeoJSON(b);else for(var f=0,g=e.length;f<g;f++)b=e[f],c.coordinates.push(d.toGeoJSON(b));return c}},"gml:MultiLineString":{toGeoJSON:function(b){for(var c={type:"MultiLineString",coordinates:[]},e=b.getElementsByTagNameNS(a.gml,"LineString"),f=0,g=e.length;f<g;f++){var h=e[f],i=d.toGeoJSON(h).coordinates;c.coordinates.push(i)}return c}},"gml:LinearRing":{toGeoJSON:function(a){return d["gml:lineString"].toGeoJSON(a).coordinates}},"gml:Polygon":{toGeoJSON:function(b){var c={type:"Polygon",coordinates:[]},e=b.getElementsByTagNameNS(a.gml,"exterior");0===e.length&&(e=b.getElementsByTagNameNS(a.gml,"outerBoundaryIs"));var f=e[0],g=d.toGeoJSON(f);c.coordinates.push(g);var h=b.getElementsByTagNameNS(a.gml,"interior");0===h.length&&(h=b.getElementsByTagNameNS(a.gml,"innerBoundaryIs"));for(var i=0,j=h.length;i<j;i++){var k=h[i],l=d.toGeoJSON(k);c.coordinates.push(l)}return c}},"gml:MultiPolygon":{toGeoJSON:function(b){for(var c={type:"MultiPolygon",coordinates:[]},e=b.getElementsByTagNameNS(a.gml,"Polygon"),f=0,g=e.length;f<g;f++){var h=e[f],i=d.toGeoJSON(h).coordinates;c.coordinates.push(i)}return c}}};L.TileLayer.WMS.Format["application/vnd.ogc.gml"]={priority:4,toGeoJSON:function(a){var b=L.TileLayer.WMS.Util.XML.parse(a);return d.toGeoJSON(b)}}}(),L.TileLayer.WMS.Format["text/xml"]={priority:5,toGeoJSON:function(a){return L.TileLayer.WMS.Format["application/vnd.ogc.wms_xml"].toGeoJSON(a)}},L.TileLayer.WMS.Format["application/vnd.ogc.wms_xml"]={priority:6,toGeoJSON:function(a){for(var b={type:"FeatureCollection",features:[]},c=L.TileLayer.WMS.Util.XML.parse(a),d=c.getElementsByTagName("FIELDS"),e=0,f=d.length;e<f;e++){var g={type:"Feature",geometry:null,properties:{}},h=d[e],i=h.attributes;for(var j in i)if(i.hasOwnProperty(j)){var k=i[j];g.properties[k.name]=k.value||null}b.features.push(g)}return b}},L.TileLayer.WMS.Format["text/html"]={priority:7,toGeoJSON:function(a){var b={type:"FeatureCollection",features:[]},c=L.TileLayer.WMS.Util.XML.parse(a),d=c.getElementsByTagName("table")[0];if(!d)return b;for(var e=[],f=d.getElementsByTagName("th"),g=0,h=f.length;g<h;g++){var i=f[g];e.push(L.TileLayer.WMS.Util.XML.getElementText(i))}for(var j=d.getElementsByTagName("tr"),k=0,l=j.length;k<l;k++){var m=j[k],n=m.getElementsByTagName("td");if(n.length===e.length){for(var o={type:"Feature",geometry:null,properties:{}},p=0,q=n.length;p<q;p++){var r=n[p];o.properties[e[p]]=L.TileLayer.WMS.Util.XML.getElementText(r)||null}b.features.push(o)}}return b}},L.TileLayer.WMS.include({_capabilities:null,getCapabilities:function(a){a=L.Util.extend({fail:function(a){throw a}},a||{});var b=this,c=function(c,d){"function"==typeof a.done&&a.done.call(b,c,d),"function"==typeof a.always&&a.always.call(b)},d=function(c,d){"function"==typeof a.fail&&a.fail.call(b,c,d),"function"==typeof a.always&&a.always.call(b)},e=b._capabilities;return e?void c(e):void L.TileLayer.WMS.Util.AJAX({url:b._url,method:"GET",content:{request:"GetCapabilities",service:"WMS",version:b.wmsParams.version},done:function(a,e){try{var f=L.TileLayer.WMS.Util.XML.ExceptionReport.parse(a);if(f)throw new Error(f.message);var g=L.TileLayer.WMS.Util.XML.parse(a);b._capabilities=g,c(g,e)}catch(h){d(h,e)}},fail:d})}}),L.TileLayer.WMS.include({_infoFormat:null,getInfoFormat:function(a){a=L.Util.extend({fail:function(a){throw a}},a||{});var b=this,c=function(c,d){"function"==typeof a.done&&a.done.call(b,c,d),"function"==typeof a.always&&a.always.call(b)},d=function(c,d){"function"==typeof a.fail&&a.fail.call(b,c,d),"function"==typeof a.always&&a.always.call(b)},e=b._infoFormat;return e?void c(e):void b.getCapabilities({done:function(a,f){try{for(var g=L.TileLayer.WMS.Format.getExisting(),h=[],i=a.getElementsByTagName("Capability")[0],j=i.getElementsByTagName("GetFeatureInfo")[0],k=j.getElementsByTagName("Format"),l=0,m=k.length;l<m;l++){var n=k[l];h.push(L.TileLayer.WMS.Util.XML.getElementText(n).trim().toLowerCase())}for(var o=0,p=g.length;o<p;o++){var q=g[o];if(h.indexOf(q)>=0){e=q;break}}b._infoFormat=e,c(e,f)}catch(r){d(r,f)}},fail:d})}}),L.TileLayer.WMS.include({getFeatureInfo:function(a){a=L.Util.extend({fail:function(a){throw a}},a||{});var b=this,c=function(c,d){"function"==typeof a.done&&a.done.call(b,c,d),"function"==typeof a.always&&a.always.call(b)},d=function(c,d){"function"==typeof a.fail&&a.fail.call(b,c,d),"function"==typeof a.always&&a.always.call(b)},e=a.infoFormat?function(b){b.done(a.infoFormat)}:b.getInfoFormat;e.call(b,{done:function(e,f){var g;try{var h;if(!e)throw h="None of available formats for '"+b._url+"' 'GetFeatureInfo' requests are not implemented in 'L.TileLayer.WMS'. 'GetFeatureInfo' request can't be performed.",new Error(h);if(!L.TileLayer.WMS.Format[e])throw h="Format '"+e+"' ' is not implemented in 'L.TileLayer.WMS'. 'GetFeatureInfo' request can't be performed.",new Error(h);var i=b._map,j=a.latlng,k=i.latLngToContainerPoint(j,i.getZoom()),l=i.getSize(),m=b.options.crs||i.options.crs,n=i.getBounds(),o=m.project(n.getNorthWest()),p=m.project(n.getSouthEast());g={request:"GetFeatureInfo",service:"WMS",version:b.wmsParams.version,layers:b.wmsParams.layers,query_layers:b.wmsParams.layers,info_format:e,height:l.y,width:l.x};var q=window.parseFloat(b.wmsParams.version);g[q>=1.3?"crs":"srs"]=m.code,g.bbox=q>=1.3&&m===L.CRS.EPSG4326?p.y+","+o.x+","+o.y+","+p.x:o.x+","+p.y+","+p.x+","+o.y,g["1.3.0"===g.version?"i":"x"]=k.x,g["1.3.0"===g.version?"j":"y"]=k.y}catch(r){return void d(r)}L.TileLayer.WMS.Util.AJAX({url:b._url,method:"GET",content:g,done:function(a,b){try{var f=L.TileLayer.WMS.Util.XML.ExceptionReport.parse(a);if(f)throw new Error(f.message);var g=L.TileLayer.WMS.Format[e].toGeoJSON(a);g.crs=m,c(g,b)}catch(h){d(h,b)}},fail:d})},fail:d})}})}(window,document);